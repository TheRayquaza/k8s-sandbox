apiVersion: v1
kind: ConfigMap
metadata:
  name: cilium-config
  namespace: kube-system
data:
  # Core settings
  enable-ipv4: "true"
  enable-ipv6: "false"

  # Masquerading
  enable-ipv4-masquerade: "true"
  enable-bpf-masquerade: "false"
  bpf-masquerade: "false"
  ipv4-native-routing-cidr: "10.0.0.0/8"
  enable-masquerade-to-route-source: "false"
  
  # Routing
  routing-mode: "tunnel"
  tunnel-protocol: "vxlan"
  auto-direct-node-routes: "false"
  
  # IPAM
  ipam: "cluster-pool"
  cluster-pool-ipv4-cidr: "10.0.0.0/16"
  cluster-pool-ipv4-mask-size: "24"
  
  # Kube-proxy replacement
  kube-proxy-replacement: "false"
  enable-node-port: "true"
  
  # Install iptables rules for masquerading
  install-no-conntrack-iptables-rules: "false"
  
  # BPF settings
  bpf-lb-mode-annotation: "false"
  bpf-lb-sock: "false"
  bpf-lb-external-clusterip: "false"
  bpf-map-dynamic-size-ratio: "0.0025"
  
  # Network Policy
  enable-k8s-networkpolicy: "true"
  enable-policy: "default"
  
  # DNS
  dnsproxy-enable-transparent-mode: "true"
  tofqdns-enable-dns-compression: "true"
  tofqdns-dns-reject-response-code: "refused"
  
  # Hubble
  enable-hubble: "true"
  hubble-listen-address: ":4244"
  hubble-socket-path: "/var/run/cilium/hubble.sock"
  
  # Health checks
  enable-health-checking: "true"
  enable-endpoint-health-checking: "true"
  enable-health-check-nodeport: "true"
  
  # Misc
  enable-l7-proxy: "true"
  enable-metrics: "true"
  enable-tcx: "true"
  enable-xt-socket-fallback: "true"
  
  # Identity & CRD
  identity-allocation-mode: "crd"
  identity-gc-interval: "15m0s"
  
  # CNI
  cni-exclusive: "true"
  cni-log-file: "/var/run/cilium/cilium-cni.log"
  write-cni-conf-when-ready: "/host/etc/cni/net.d/05-cilium.conflist"
